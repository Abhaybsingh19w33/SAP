REPORT Z.
DATA FLIGHTS TYPE TABLE OF SPFLI WITH EMPTY KEY.

SELECT * FROM  SPFLI
         WHERE CARRID = 'AA'
         INTO TABLE @FLIGHTS.
DATA MEMBERS LIKE FLIGHTS.

LOOP AT FLIGHTS INTO DATA(FLIGHT)
     GROUP BY ( CARRIER = FLIGHT-CARRID CITYFR = FLIGHT-CITYFROM )
              ASCENDING
             ASSIGNING FIELD-SYMBOL(<GROUP>).
  CLEAR MEMBERS.
  LOOP AT GROUP <GROUP> ASSIGNING FIELD-SYMBOL(<FLIGHT>).
    MEMBERS = VALUE #( BASE MEMBERS ( <FLIGHT> ) ).
  ENDLOOP.
  CL_DEMO_OUTPUT=>WRITE( MEMBERS ).
ENDLOOP.
CL_DEMO_OUTPUT=>DISPLAY( ).