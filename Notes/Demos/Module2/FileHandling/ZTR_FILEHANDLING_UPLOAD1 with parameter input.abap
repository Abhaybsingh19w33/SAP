REPORT ZTR_FILEHANDLING.
TYPES: BEGIN OF IT_TABTYPE,
         MATNR(18),
         MBRSH(1),
         MTART(4),
         MAKTX(40),
         MEINS(3),
         MATKL(9),
       END OF IT_TABTYPE.

DATA IT_TAB TYPE TABLE OF IT_TABTYPE INITIAL SIZE 0.
DATA WA TYPE IT_TABTYPE.

PARAMETERS P_FILE TYPE RLGRAP-FILENAME.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE.
*
  CALL FUNCTION 'F4_FILENAME'
    EXPORTING
      PROGRAM_NAME  = SYST-CPROG
      DYNPRO_NUMBER = SYST-DYNNR
**     FIELD_NAME          = ' '
    IMPORTING
      FILE_NAME     = P_FILE.

START-OF-SELECTION.
  WRITE P_FILE.
*
  DATA P_FILE1 TYPE STRING.
*
  P_FILE1 = P_FILE.
*
  CALL FUNCTION 'GUI_UPLOAD'
    EXPORTING
      FILENAME            = P_FILE1
      FILETYPE            = 'ASC'
      HAS_FIELD_SEPARATOR = 'X'
    TABLES
      DATA_TAB            = IT_TAB.

  OPEN DATASET 'VKFILE1' FOR OUTPUT IN TEXT  MODE ENCODING DEFAULT.
  LOOP AT IT_TAB INTO WA.
    TRANSFER WA TO 'VKFILE1'.
    CLEAR WA.
  ENDLOOP.
  CLOSE DATASET 'VKFILE1'.