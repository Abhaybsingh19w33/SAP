REPORT Z.
DATA IT_SPFLI TYPE TABLE OF SPFLI. "DECLARE INTERNAL TABLE FOR SPFLI
DATA: IT_LISTHEADER TYPE SLIS_T_LISTHEADER,
      WA_LISTHEADER TYPE SLIS_LISTHEADER.

START-OF-SELECTION.
  SELECT * FROM SPFLI INTO TABLE IT_SPFLI.
  PERFORM BUILD_ALV_HEADER.

  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY' "CALL FUNCTION MODULE TO DISPLAY ALV GRID
    EXPORTING
      I_STRUCTURE_NAME       = 'SPFLI'
      I_CALLBACK_PROGRAM     = SY-REPID
      I_CALLBACK_TOP_OF_PAGE = 'FMTOPPAGE'
    TABLES
      T_OUTTAB               = IT_SPFLI. "PASS INTERNAL TABLE TO DISPLAY ALV FORMAT


FORM BUILD_ALV_HEADER .
*  Type H is used to display headers i.e. big font
  WA_LISTHEADER-TYP  = 'H'.
  WA_LISTHEADER-INFO ='Flight Details'.
  APPEND WA_LISTHEADER TO IT_LISTHEADER.
  CLEAR WA_LISTHEADER.

*  Type S is used to display key and value pairs
  WA_LISTHEADER-TYP = 'S'.
  WA_LISTHEADER-KEY = 'Date :' .
*Date format is YYYYMMDD
  CONCATENATE  SY-DATUM+6(2)   "DD DATE
                SY-DATUM+4(2) "MM MONTH
                SY-DATUM(4) "YYYY YEAR
                INTO WA_LISTHEADER-INFO
               SEPARATED BY '/'.
  APPEND WA_LISTHEADER TO IT_LISTHEADER.
  CLEAR WA_LISTHEADER.

***  Type A is used to display italic font
  WA_LISTHEADER-TYP = 'A'.
  WA_LISTHEADER-INFO ='SAP ALV Report'.
  APPEND WA_LISTHEADER TO IT_LISTHEADER.
  CLEAR WA_LISTHEADER.
ENDFORM.                    " BUILD_ALV_HEADER

FORM FMTOPPAGE.
  CALL FUNCTION 'REUSE_ALV_COMMENTARY_WRITE'
    EXPORTING
      IT_LIST_COMMENTARY = IT_LISTHEADER.

ENDFORM.