REPORT  Z.
TYPE-POOLS SLIS .
TABLES SFLIGHT.
TYPES : BEGIN OF TY_SFLIGHT,
          CARRID TYPE SFLIGHT-CARRID,
          CONNID TYPE SFLIGHT-CONNID,
          FLDATE TYPE SFLIGHT-FLDATE,
          PRICE  TYPE SFLIGHT-PRICE,
        END OF TY_SFLIGHT.
DATA IT_SFLIGHT TYPE TABLE OF TY_SFLIGHT .
DATA WA_SFLIGHT TYPE TY_SFLIGHT .

DATA IT_FCAT TYPE SLIS_T_FIELDCAT_ALV .
DATA WA_FCAT TYPE SLIS_FIELDCAT_ALV.

DATA IT_SORTSPFLI TYPE SLIS_T_SORTINFO_ALV .
DATA WA_SORT TYPE SLIS_SORTINFO_ALV.

SELECT-OPTIONS : S_CARRID FOR SFLIGHT-CARRID.

START-OF-SELECTION .
  PERFORM GET_DATA .
  PERFORM CREATE_FCAT.
  PERFORM SORT.
  PERFORM DISP_ALV .

FORM GET_DATA .
  SELECT CARRID CONNID FLDATE PRICE FROM SFLIGHT
      INTO TABLE IT_SFLIGHT WHERE CARRID IN S_CARRID
  .
ENDFORM.                    " GET_DATA
FORM DISP_ALV .
  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
    EXPORTING
      IT_FIELDCAT = IT_FCAT
      IT_SORT     = IT_SORTSPFLI
    TABLES
      T_OUTTAB    = IT_SFLIGHT.
  IF SY-SUBRC NE 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

ENDFORM.                    " DISP_ALV
FORM CREATE_FCAT .
  WA_FCAT-COL_POS = '1' .
  WA_FCAT-FIELDNAME = 'CARRID' .
  WA_FCAT-SELTEXT_M = 'Airline' .
  WA_FCAT-KEY = 'X' .
  APPEND WA_FCAT TO IT_FCAT .
  CLEAR WA_FCAT .

  WA_FCAT-COL_POS = '2' .
  WA_FCAT-FIELDNAME = 'CONNID' .
  WA_FCAT-SELTEXT_M = 'Flight Number' .

  APPEND WA_FCAT TO IT_FCAT .
  CLEAR WA_FCAT .

  WA_FCAT-COL_POS = '3' .
  WA_FCAT-FIELDNAME = 'FLDATE' .
  WA_FCAT-SELTEXT_M = 'Flight Date' .
  APPEND WA_FCAT TO IT_FCAT .
  CLEAR WA_FCAT .

  WA_FCAT-COL_POS = '4' .
  WA_FCAT-FIELDNAME = 'PRICE' .
  WA_FCAT-SELTEXT_M = 'Airfare' .
  WA_FCAT-EMPHASIZE = 'C610'.
  APPEND WA_FCAT TO IT_FCAT .
  CLEAR WA_FCAT .

ENDFORM.                    " CREATE_FCAT

FORM SORT .
  WA_SORT-FIELDNAME = 'CARRID'.
  WA_SORT-UP = 'X'.
  APPEND WA_SORT TO IT_SORTSPFLI .

  WA_SORT-FIELDNAME = 'CONNID'.
  WA_SORT-UP = 'X'.
  APPEND WA_SORT TO IT_SORTSPFLI .

ENDFORM.