TYPES: BEGIN OF FLIGHTTYPE,
         FLDATE     TYPE SFLIGHT-FLDATE,
         PLANETYPE  TYPE SFLIGHT-PLANETYPE,
         CARRID     TYPE SFLIGHT-CARRID,
         CONNID     TYPE SFLIGHT-CONNID,
         SEATSMAX   TYPE SFLIGHT-SEATSMAX,
         SEATSOCC   TYPE SFLIGHT-SEATSOCC,
         SEATSFREE  TYPE SFLIGHT-SEATSOCC,
       END OF   FLIGHTTYPE.
DATA: ITSFLIGHT1  TYPE STANDARD TABLE OF FLIGHTTYPE INITIAL SIZE 0,
      ITSFLIGHT2 TYPE STANDARD TABLE OF FLIGHTTYPE INITIAL SIZE 5,
      FLIGHTDATA TYPE  FLIGHTTYPE.

FLIGHTDATA-CARRID = 'AA'. FLIGHTDATA-CONNID = '17'. FLIGHTDATA-FLDATE = '20190731'.
FLIGHTDATA-PLANETYPE = '747-400'. FLIGHTDATA-SEATSMAX = 385. FLIGHTDATA-SEATSOCC = 375.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'AZ'. FLIGHTDATA-CONNID = '64'. FLIGHTDATA-FLDATE = '20190827'.
FLIGHTDATA-PLANETYPE = 'DC-10-10'. FLIGHTDATA-SEATSMAX = 380. FLIGHTDATA-SEATSOCC = 367.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'DL'. FLIGHTDATA-CONNID = '17'. FLIGHTDATA-FLDATE = '20190923'.
FLIGHTDATA-PLANETYPE = 'A310-300'. FLIGHTDATA-SEATSMAX = 280. FLIGHTDATA-SEATSOCC = 271.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'AZ'. FLIGHTDATA-CONNID = '64'. FLIGHTDATA-FLDATE = '20190731'.
FLIGHTDATA-PLANETYPE = 'A319'. FLIGHTDATA-SEATSMAX = 220. FLIGHTDATA-SEATSOCC = 211.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'AA'. FLIGHTDATA-CONNID = '17'. FLIGHTDATA-FLDATE = '20190830'.
FLIGHTDATA-PLANETYPE = 'A310-300'. FLIGHTDATA-SEATSMAX = 280. FLIGHTDATA-SEATSOCC = 261.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'DL'. FLIGHTDATA-CONNID = '64'. FLIGHTDATA-FLDATE = '20190923'.
FLIGHTDATA-PLANETYPE = 'A319'. FLIGHTDATA-SEATSMAX = 220. FLIGHTDATA-SEATSOCC = 213.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'AA'. FLIGHTDATA-CONNID = '64'. FLIGHTDATA-FLDATE = '20190828'.
FLIGHTDATA-PLANETYPE = '747-400'.  FLIGHTDATA-SEATSMAX = 385. FLIGHTDATA-SEATSOCC = 371.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'AZ'. FLIGHTDATA-CONNID = '17'. FLIGHTDATA-FLDATE = '20190828'.
FLIGHTDATA-PLANETYPE = 'A319'. FLIGHTDATA-SEATSMAX = 220. FLIGHTDATA-SEATSOCC = 205.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'AA'. FLIGHTDATA-CONNID = '64'. FLIGHTDATA-FLDATE = '20190802'.
FLIGHTDATA-PLANETYPE = 'A310-300'. FLIGHTDATA-SEATSMAX = 280. FLIGHTDATA-SEATSOCC = 271.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'AZ'. FLIGHTDATA-CONNID = '17'. FLIGHTDATA-FLDATE = '20190924'.
FLIGHTDATA-PLANETYPE = 'DC-10-10'. FLIGHTDATA-SEATSMAX = 380. FLIGHTDATA-SEATSOCC = 370.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'DL'. FLIGHTDATA-CONNID = '17'. FLIGHTDATA-FLDATE = '20190826'.
FLIGHTDATA-PLANETYPE = 'A310-300'. FLIGHTDATA-SEATSMAX = 280. FLIGHTDATA-SEATSOCC = 270.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'AZ'. FLIGHTDATA-CONNID = '64'. FLIGHTDATA-FLDATE = '20190802'.
FLIGHTDATA-PLANETYPE = 'DC-10-10'. FLIGHTDATA-SEATSMAX = 380. FLIGHTDATA-SEATSOCC = 361.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'DL'. FLIGHTDATA-CONNID = '64'. FLIGHTDATA-FLDATE = '20190826'.
FLIGHTDATA-PLANETYPE = 'A319'. FLIGHTDATA-SEATSMAX = 220. FLIGHTDATA-SEATSOCC = 213.
APPEND FLIGHTDATA TO ITSFLIGHT1.

FLIGHTDATA-CARRID = 'AZ'. FLIGHTDATA-CONNID = '64'. FLIGHTDATA-FLDATE = '20190828'.
FLIGHTDATA-PLANETYPE = 'A310-300'. FLIGHTDATA-SEATSMAX = 380. FLIGHTDATA-SEATSOCC = 361.
APPEND FLIGHTDATA TO ITSFLIGHT1.

LOOP AT ITSFLIGHT1 INTO FLIGHTDATA.
  FLIGHTDATA-SEATSFREE = FLIGHTDATA-SEATSMAX - FLIGHTDATA-SEATSOCC.
  APPEND FLIGHTDATA TO ITSFLIGHT2 SORTED BY SEATSFREE.
ENDLOOP.

LOOP AT ITSFLIGHT2 INTO FLIGHTDATA .
  WRITE:/ FLIGHTDATA-FLDATE,
  FLIGHTDATA-SEATSMAX,FLIGHTDATA-SEATSOCC,
  FLIGHTDATA-SEATSFREE.
ENDLOOP.